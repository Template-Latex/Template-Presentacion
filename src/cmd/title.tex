% Template:     Presentación LaTeX
% Documento:    Funciones para insertar títulos
% Versión:      1.4.5 (27/09/2021)
% Codificación: UTF-8
%
% Autor: Pablo Pizarro R.
%        pablo@ppizarror.com
%
% Manual template: [https://latex.ppizarror.com/presentacion]
% Licencia MIT:    [https://opensource.org/licenses/MIT]

% Activa la numeración en las secciones
\def\coreintializetitlenumbering {
	% Section
	\ifthenelse{\equal{\GLOBALchapternumenabled}{false}}{
		\ifthenelse{\equal{\GLOBALsectionalph}{true}}{
			\renewcommand{\thesection}{\Alph{section}}
		}{
			\renewcommand{\thesection}{\arabic{section}}
		}
	}{
		\ifthenelse{\equal{\GLOBALsectionalph}{true}}{
			\renewcommand{\thesection}{\thechapter.\Alph{section}}
		}{
			\renewcommand{\thesection}{\thechapter.\arabic{section}}
		}
	}
	% Subsection
	\ifthenelse{\equal{\GLOBALsectionanumenabled}{true}}{
		\renewcommand{\thesubsection}{\arabic{subsection}}
	}{
		\renewcommand{\thesubsection}{\thesection.\arabic{subsection}}
	}
	% Subsubsection
	\ifthenelse{\equal{\GLOBALsubsectionanumenabled}{true}}{
		\renewcommand{\thesubsubsection}{\arabic{subsubsection}}
	}{
		\renewcommand{\thesubsubsection}{\thesubsection.\arabic{subsubsection}}
	}
	% Subsubsubsection
	\ifthenelse{\equal{\GLOBALsubsectionanumenabled}{true}}{
		\ifthenelse{\equal{\dotaftersnum}{true}}{
			\renewcommand{\thesubsubsubsection}{\arabic{subsubsection}.\arabic{subsubsubsection}.}
		}{
			\renewcommand{\thesubsubsubsection}{\arabic{subsubsection}.\arabic{subsubsubsection}}
		}
	}{
		\ifthenelse{\equal{\dotaftersnum}{true}}{
			\renewcommand{\thesubsubsubsection}{\thesubsubsection.\arabic{subsubsubsection}.}
		}{
			\renewcommand{\thesubsubsubsection}{\thesubsubsection.\arabic{subsubsubsection}}
		}
	}
	\hbadness=10000%
}

% Parcha el formato de capítulos
\pretocmd{\chapter}{
	\ifthenelse{\equal{\showsectioncaptioncode}{chap}}{ % Reinicia código fuente
		\addtocounter{templateListings}{\value{lstlisting}}%
		\setcounter{lstlisting}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptioneqn}{chap}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\equationrestart}{chap}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptionfig}{chap}}{ % Reinicia figuras
		\addtocounter{templateFigures}{\value{figure}}%
		\setcounter{figure}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptiontab}{chap}}{ % Reinicia tablas
		\addtocounter{templateTables}{\value{table}}%
		\setcounter{table}{0}%
	}{}
	\global\def\GLOBALchapternumenabled {true}%
	\coreintializetitlenumbering%
}{}{}

% Parcha el formato de secciones al pasar desde una anum, vuelve a activar número
% de la sección
\pretocmd{\section}{
	\ifthenelse{\equal{\showsectioncaptioncode}{sec}}{ % Reinicia código fuente
		\addtocounter{templateListings}{\value{lstlisting}}%
		\setcounter{lstlisting}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptioneqn}{sec}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\equationrestart}{sec}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptionfig}{sec}}{ % Reinicia figuras
		\addtocounter{templateFigures}{\value{figure}}%
		\setcounter{figure}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptiontab}{sec}}{ % Reinicia tablas
		\addtocounter{templateTables}{\value{table}}%
		\setcounter{table}{0}%
	}{}
	\global\def\GLOBALsectionanumenabled {false}%
	\global\def\GLOBALsubsectionanumenabled {false}%
	\coreintializetitlenumbering%
}{}{}

% Comienza nueva subsección, si está dentro de una sectionanum entonces no dibuja el
% número de sección, si no entonces dibuja el número de forma normal
\pretocmd{\subsection}{
	\ifthenelse{\equal{\showsectioncaptioncode}{ssec}}{ % Reinicia código fuente
		\addtocounter{templateListings}{\value{lstlisting}}%
		\setcounter{lstlisting}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptioneqn}{ssec}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\equationrestart}{ssec}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptionfig}{ssec}}{ % Reinicia figuras
		\addtocounter{templateFigures}{\value{figure}}%
		\setcounter{figure}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptiontab}{ssec}}{ % Reinicia tablas
		\addtocounter{templateTables}{\value{table}}%
		\setcounter{table}{0}%
	}{}
	\global\def\GLOBALsubsectionanumenabled {false}%
	\coreintializetitlenumbering%
}{}{}

% Comienza nueva subsubsección, aquí hay varios casos:
%	- si está dentro de una subsección sin número ignora la sección
%	- si no, entonces puede estar dentro de una sección sin número o no, en ese caso
%	  debe evaluar ambas posibilidades
\pretocmd{\subsubsection}{
	\ifthenelse{\equal{\showsectioncaptioncode}{sssec}}{ % Reinicia código fuente
		\addtocounter{templateListings}{\value{lstlisting}}%
		\setcounter{lstlisting}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptioneqn}{sssec}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\equationrestart}{sssec}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptionfig}{sssec}}{ % Reinicia figuras
		\addtocounter{templateFigures}{\value{figure}}%
		\setcounter{figure}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptiontab}{sssec}}{ % Reinicia tablas
		\addtocounter{templateTables}{\value{table}}%
		\setcounter{table}{0}%
	}{}
	\coreintializetitlenumbering%
}{}{}

\pretocmd{\subsubsubsection}{
	\ifthenelse{\equal{\showsectioncaptioncode}{ssssec}}{ % Reinicia código fuente
		\addtocounter{templateListings}{\value{lstlisting}}%
		\setcounter{lstlisting}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptioneqn}{ssssec}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\equationrestart}{ssssec}}{ % Reinicia ecuaciones
		\addtocounter{templateEquations}{\value{equation}}%
		\setcounter{equation}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptionfig}{ssssec}}{ % Reinicia figuras
		\addtocounter{templateFigures}{\value{figure}}%
		\setcounter{figure}{0}%
	}{}
	\ifthenelse{\equal{\showsectioncaptiontab}{ssssec}}{ % Reinicia tablas
		\addtocounter{templateTables}{\value{table}}%
		\setcounter{table}{0}%
	}{}
}{}{}
